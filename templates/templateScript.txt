USE {0}
BEGIN TRAN
GO
SET NUMERIC_ROUNDABORT OFF
GO
SET ANSI_PADDING, ANSI_WARNINGS, CONCAT_NULL_YIELDS_NULL, ARITHABORT, QUOTED_IDENTIFIER, ANSI_NULLS ON
GO
SET XACT_ABORT OFF
GO
SELECT GETDATE(), DB_NAME(), USER_NAME(), SUSER_NAME(), @@SERVERNAME
GO

declare @L_CONTADOR int = 0

{2}

IF @l_contador = {1}
COMMIT TRAN
ELSE
ROLLBACK TRAN
GO
IF @@trancount = 0
BEGIN
  DECLARE @MENSAGEM VARCHAR(100)
  SET @MENSAGEM = 'ERRO DE TRANSAÇÕES - EXISTE(M) ' + CAST(@@TRANCOUNT AS VARCHAR(9))+ ' BEGIN(S) A MAIS NO SCRIPT'
  ROLLBACK TRAN
  RAISERROR( @MENSAGEM, 16, 1)
END
ELSE
SELECT GETDATE(), DB_NAME(), USER_NAME(), SUSER_NAME(), @@SERVERNAME